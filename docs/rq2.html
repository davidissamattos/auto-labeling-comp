<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 RQ2 | Automatic labeling comparisson - Online appendix</title>
  <meta name="description" content="Chapter 2 RQ2 | Automatic labeling comparisson - Online appendix" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 RQ2 | Automatic labeling comparisson - Online appendix" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 RQ2 | Automatic labeling comparisson - Online appendix" />
  
  
  

<meta name="author" content="Teodor Fredriksson, David Issa Mattos, Jan Bosch, Helena HolmstrÃ¶m Olsson" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="rq1.html"/>

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#compiling-this-document"><i class="fa fa-check"></i>Compiling this document</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="rq1.html"><a href="rq1.html"><i class="fa fa-check"></i><b>1</b> RQ1</a><ul>
<li class="chapter" data-level="1.1" data-path="rq1.html"><a href="rq1.html#descriptive-statistics"><i class="fa fa-check"></i><b>1.1</b> Descriptive statistics</a></li>
<li class="chapter" data-level="1.2" data-path="rq1.html"><a href="rq1.html#bradley-terry-model-for-ranking"><i class="fa fa-check"></i><b>1.2</b> Bradley terry model for ranking</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="rq2.html"><a href="rq2.html"><i class="fa fa-check"></i><b>2</b> RQ2</a><ul>
<li class="chapter" data-level="2.1" data-path="rq1.html"><a href="rq1.html#descriptive-statistics"><i class="fa fa-check"></i><b>2.1</b> Descriptive statistics</a></li>
<li class="chapter" data-level="2.2" data-path="rq1.html"><a href="rq1.html#bradley-terry-model-for-ranking"><i class="fa fa-check"></i><b>2.2</b> Bradley terry model for ranking</a></li>
<li class="chapter" data-level="2.3" data-path="rq2.html"><a href="rq2.html#results-for-10"><i class="fa fa-check"></i><b>2.3</b> Results for 10%</a></li>
<li class="chapter" data-level="2.4" data-path="rq2.html"><a href="rq2.html#results-for-50"><i class="fa fa-check"></i><b>2.4</b> Results for 50%</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Automatic labeling comparisson - Online appendix</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="rq2" class="section level1">
<h1><span class="header-section-number">Chapter 2</span> RQ2</h1>
<p>How do the rank of these algorithms change with changes in the amount of manual label effort prior to applying these methods?</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="rq2.html#cb21-1"></a>d &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&#39;./data/auto-label-comparison.csv&#39;</span>) <span class="op">%&gt;%</span></span>
<span id="cb21-2"><a href="rq2.html#cb21-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(ValueType<span class="op">==</span><span class="st">&#39;Accuracy&#39;</span>)</span>
<span id="cb21-3"><a href="rq2.html#cb21-3"></a>d10 &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(d,Variable<span class="op">==</span><span class="st">&#39;10%&#39;</span>)</span>
<span id="cb21-4"><a href="rq2.html#cb21-4"></a>d50 &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw">filter</span>(d,Variable<span class="op">==</span><span class="st">&#39;50%&#39;</span>)</span></code></pre></div>
<div id="descriptive-statistics" class="section level2">
<h2><span class="header-section-number">2.1</span> Descriptive statistics</h2>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="rq2.html#cb22-1"></a>p&lt;-<span class="kw">ggplot</span>(<span class="dt">data=</span>d, <span class="kw">aes</span>(<span class="dt">x=</span>Model, <span class="dt">y=</span>Value, <span class="dt">fill=</span>Model))<span class="op">+</span></span>
<span id="cb22-2"><a href="rq2.html#cb22-2"></a><span class="st">  </span><span class="kw">geom_boxplot</span>()<span class="op">+</span></span>
<span id="cb22-3"><a href="rq2.html#cb22-3"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_blank</span>())<span class="op">+</span><span class="st"> </span><span class="co">#remove the x labels</span></span>
<span id="cb22-4"><a href="rq2.html#cb22-4"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>Variable)<span class="op">+</span></span>
<span id="cb22-5"><a href="rq2.html#cb22-5"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&#39;Accuracy (all datasets)&#39;</span>)</span>
<span id="cb22-6"><a href="rq2.html#cb22-6"></a>p</span></code></pre></div>
<p><img src="automatic-labelling_files/figure-html/unnamed-chunk-18-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="rq2.html#cb23-1"></a><span class="kw">save_fig</span>(p,<span class="st">&#39;aggregatedmanualeffortboxplots.pdf&#39;</span>)</span></code></pre></div>
<p>A respective table for this box-plot but with 5% and 95% quantiles</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="rq2.html#cb24-1"></a>d <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb24-2"><a href="rq2.html#cb24-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(Variable,Model) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb24-3"><a href="rq2.html#cb24-3"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">Mean =</span> <span class="kw">mean</span>(Value),</span>
<span id="cb24-4"><a href="rq2.html#cb24-4"></a>            <span class="dt">SD =</span> <span class="kw">sd</span>(Value),</span>
<span id="cb24-5"><a href="rq2.html#cb24-5"></a>            <span class="dt">Median =</span> <span class="kw">median</span>(Value),</span>
<span id="cb24-6"><a href="rq2.html#cb24-6"></a>            <span class="st">&#39;5%&#39;</span> =<span class="st"> </span><span class="kw">quantile</span>(Value,<span class="fl">0.05</span>),</span>
<span id="cb24-7"><a href="rq2.html#cb24-7"></a>            <span class="st">&#39;95%&#39;</span> =<span class="st"> </span><span class="kw">quantile</span>(Value,<span class="fl">0.95</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb24-8"><a href="rq2.html#cb24-8"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb24-9"><a href="rq2.html#cb24-9"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>Variable) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb24-10"><a href="rq2.html#cb24-10"></a><span class="st">  </span><span class="kw">kable</span>(</span>
<span id="cb24-11"><a href="rq2.html#cb24-11"></a>        <span class="st">&quot;latex&quot;</span>, </span>
<span id="cb24-12"><a href="rq2.html#cb24-12"></a>        <span class="dt">table.envir =</span> <span class="st">&#39;table&#39;</span>,</span>
<span id="cb24-13"><a href="rq2.html#cb24-13"></a>        <span class="dt">caption=</span><span class="st">&#39;Summary statistics for the accuracy aggregated data&#39;</span>, </span>
<span id="cb24-14"><a href="rq2.html#cb24-14"></a>        <span class="dt">booktabs=</span>T,</span>
<span id="cb24-15"><a href="rq2.html#cb24-15"></a>        <span class="dt">label=</span><span class="st">&#39;summarystatisticstable&#39;</span>,</span>
<span id="cb24-16"><a href="rq2.html#cb24-16"></a>        <span class="dt">format.args =</span> <span class="kw">list</span>(<span class="dt">scientific =</span> <span class="ot">FALSE</span>), </span>
<span id="cb24-17"><a href="rq2.html#cb24-17"></a>        <span class="dt">digits =</span> <span class="dv">3</span>,</span>
<span id="cb24-18"><a href="rq2.html#cb24-18"></a>        <span class="dt">linesep =</span> <span class="st">&quot;&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb24-19"><a href="rq2.html#cb24-19"></a><span class="st">  </span><span class="kw">pack_rows</span>(<span class="st">&quot;10% labels available&quot;</span>,<span class="dv">1</span>, n_models) <span class="op">%&gt;%</span></span>
<span id="cb24-20"><a href="rq2.html#cb24-20"></a><span class="st">  </span><span class="kw">pack_rows</span>(<span class="st">&quot;50% labels available&quot;</span>,<span class="dv">1</span><span class="op">+</span>n_models,<span class="dv">2</span><span class="op">*</span>n_models) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb24-21"><a href="rq2.html#cb24-21"></a><span class="st">    </span><span class="kw">kable_styling</span>(<span class="dt">latex_options =</span> <span class="kw">c</span>(<span class="st">&quot;hold_position&quot;</span>),</span>
<span id="cb24-22"><a href="rq2.html#cb24-22"></a>                  <span class="dt">full_width =</span> F) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb24-23"><a href="rq2.html#cb24-23"></a><span class="st">    </span>readr<span class="op">::</span><span class="kw">write_lines</span>(<span class="st">&#39;./paper/summarystatisticstablemanualeffort.tex&#39;</span>)</span></code></pre></div>
</div>
<div id="bradley-terry-model-for-ranking" class="section level2">
<h2><span class="header-section-number">2.2</span> Bradley terry model for ranking</h2>
<p>To create a Bradley terry model we need first to transform our dataset to paired comparisons
On each iteration for each dataset for each variable we will rank the models based on the Value of the accuracy (lower accuracy -&gt; smaller)
After we expand it to wide so we can compare each algorithm with each other and create a BT dataset</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="rq2.html#cb25-1"></a>d_acc_rank_<span class="dv">10</span> &lt;-<span class="st"> </span>d10 <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb25-2"><a href="rq2.html#cb25-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(Dataset, Variable, iterations) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb25-3"><a href="rq2.html#cb25-3"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">Rank=</span><span class="op">-</span><span class="kw">rank</span>(Value, <span class="dt">ties.method =</span> <span class="st">&#39;random&#39;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb25-4"><a href="rq2.html#cb25-4"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb25-5"><a href="rq2.html#cb25-5"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>Value) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#we need to drop the Value variable to pivot wider</span></span>
<span id="cb25-6"><a href="rq2.html#cb25-6"></a><span class="st">  </span>tidyr<span class="op">::</span><span class="kw">pivot_wider</span>(<span class="dt">names_from =</span> Model,</span>
<span id="cb25-7"><a href="rq2.html#cb25-7"></a>                     <span class="dt">values_from=</span>Rank)</span>
<span id="cb25-8"><a href="rq2.html#cb25-8"></a></span>
<span id="cb25-9"><a href="rq2.html#cb25-9"></a>d_acc_rank_<span class="dv">50</span> &lt;-<span class="st"> </span>d50 <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb25-10"><a href="rq2.html#cb25-10"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(Dataset, Variable, iterations) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb25-11"><a href="rq2.html#cb25-11"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">Rank=</span><span class="op">-</span><span class="kw">rank</span>(Value, <span class="dt">ties.method =</span> <span class="st">&#39;random&#39;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb25-12"><a href="rq2.html#cb25-12"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb25-13"><a href="rq2.html#cb25-13"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>Value) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#we need to drop the Value variable to pivot wider</span></span>
<span id="cb25-14"><a href="rq2.html#cb25-14"></a><span class="st">  </span>tidyr<span class="op">::</span><span class="kw">pivot_wider</span>(<span class="dt">names_from =</span> Model,</span>
<span id="cb25-15"><a href="rq2.html#cb25-15"></a>                     <span class="dt">values_from=</span>Rank)</span></code></pre></div>
<p>Now we can create the BT dataset</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="rq2.html#cb26-1"></a><span class="co">#a vector with the name of the algorithms</span></span>
<span id="cb26-2"><a href="rq2.html#cb26-2"></a>models &lt;-<span class="st"> </span><span class="kw">get_index_names_as_array</span>(d<span class="op">$</span>Model)</span>
<span id="cb26-3"><a href="rq2.html#cb26-3"></a></span>
<span id="cb26-4"><a href="rq2.html#cb26-4"></a>n_models =<span class="st"> </span><span class="kw">length</span>(models)</span>
<span id="cb26-5"><a href="rq2.html#cb26-5"></a>comb &lt;-<span class="st"> </span>gtools<span class="op">::</span><span class="kw">combinations</span>(<span class="dt">n=</span>n_models, <span class="dt">r=</span><span class="dv">2</span>, <span class="dt">v=</span><span class="kw">seq</span>(<span class="dv">1</span><span class="op">:</span>n_models), <span class="dt">repeats.allowed =</span> F) <span class="co">#all teh paired combinations</span></span>
<span id="cb26-6"><a href="rq2.html#cb26-6"></a></span>
<span id="cb26-7"><a href="rq2.html#cb26-7"></a>d_acc_bt_<span class="dv">10</span> &lt;-<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">tribble</span>(<span class="op">~</span>model0_name, <span class="op">~</span>model0, <span class="op">~</span>model1_name, <span class="op">~</span>model1, <span class="op">~</span>y, <span class="op">~</span>iterations, <span class="op">~</span>Dataset, <span class="op">~</span>DatasetType)</span>
<span id="cb26-8"><a href="rq2.html#cb26-8"></a></span>
<span id="cb26-9"><a href="rq2.html#cb26-9"></a>d_acc_bt_<span class="dv">50</span> &lt;-<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">tribble</span>(<span class="op">~</span>model0_name, <span class="op">~</span>model0, <span class="op">~</span>model1_name, <span class="op">~</span>model1, <span class="op">~</span>y, <span class="op">~</span>iterations, <span class="op">~</span>Dataset, <span class="op">~</span>DatasetType)</span></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="rq2.html#cb27-1"></a><span class="co">#now we loop each row of the rank wide dataset and create a new one</span></span>
<span id="cb27-2"><a href="rq2.html#cb27-2"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(d_acc_rank_<span class="dv">10</span>))</span>
<span id="cb27-3"><a href="rq2.html#cb27-3"></a>{</span>
<span id="cb27-4"><a href="rq2.html#cb27-4"></a>  current_row &lt;-<span class="st"> </span>d_acc_rank_<span class="dv">10</span>[i,]</span>
<span id="cb27-5"><a href="rq2.html#cb27-5"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(comb)){</span>
<span id="cb27-6"><a href="rq2.html#cb27-6"></a>    comb_row &lt;-<span class="st"> </span>comb[j,]</span>
<span id="cb27-7"><a href="rq2.html#cb27-7"></a>    </span>
<span id="cb27-8"><a href="rq2.html#cb27-8"></a>    model0_name &lt;-<span class="st"> </span>models[comb_row[<span class="dv">1</span>]]</span>
<span id="cb27-9"><a href="rq2.html#cb27-9"></a>    model0 &lt;-<span class="st"> </span>comb_row[<span class="dv">1</span>]</span>
<span id="cb27-10"><a href="rq2.html#cb27-10"></a>    model0_rank &lt;-<span class="st"> </span>current_row[[<span class="dv">1</span>,model0_name]]</span>
<span id="cb27-11"><a href="rq2.html#cb27-11"></a>    </span>
<span id="cb27-12"><a href="rq2.html#cb27-12"></a>    model1_name &lt;-<span class="st"> </span>models[comb_row[<span class="dv">2</span>]]</span>
<span id="cb27-13"><a href="rq2.html#cb27-13"></a>    model1 &lt;-<span class="st"> </span>comb_row[<span class="dv">2</span>]</span>
<span id="cb27-14"><a href="rq2.html#cb27-14"></a>    model1_rank &lt;-<span class="st"> </span>current_row[[<span class="dv">1</span>,model1_name]]</span>
<span id="cb27-15"><a href="rq2.html#cb27-15"></a>    </span>
<span id="cb27-16"><a href="rq2.html#cb27-16"></a>    diff_rank &lt;-<span class="st"> </span>model1_rank <span class="op">-</span><span class="st"> </span>model0_rank</span>
<span id="cb27-17"><a href="rq2.html#cb27-17"></a>    <span class="co">#SInce higher accuracy is better if model 1 rank- model 0 rank is positive than model1 wins and y=1 else y=0</span></span>
<span id="cb27-18"><a href="rq2.html#cb27-18"></a>    y &lt;-<span class="st"> </span><span class="kw">ifelse</span>(diff_rank<span class="op">&gt;</span><span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>) </span>
<span id="cb27-19"><a href="rq2.html#cb27-19"></a>    </span>
<span id="cb27-20"><a href="rq2.html#cb27-20"></a>    </span>
<span id="cb27-21"><a href="rq2.html#cb27-21"></a>    d_acc_bt_<span class="dv">10</span> &lt;-d_acc_bt_<span class="dv">10</span> <span class="op">%&gt;%</span><span class="st">  </span></span>
<span id="cb27-22"><a href="rq2.html#cb27-22"></a><span class="st">      </span><span class="kw">add_row</span>(<span class="dt">model0_name=</span>model0_name,</span>
<span id="cb27-23"><a href="rq2.html#cb27-23"></a>              <span class="dt">model0=</span>model0,</span>
<span id="cb27-24"><a href="rq2.html#cb27-24"></a>              <span class="dt">model1_name=</span>model1_name,</span>
<span id="cb27-25"><a href="rq2.html#cb27-25"></a>              <span class="dt">model1=</span>model1,</span>
<span id="cb27-26"><a href="rq2.html#cb27-26"></a>              <span class="dt">y=</span>y,</span>
<span id="cb27-27"><a href="rq2.html#cb27-27"></a>              <span class="dt">iterations=</span>current_row<span class="op">$</span>iterations,</span>
<span id="cb27-28"><a href="rq2.html#cb27-28"></a>              <span class="dt">Dataset=</span>current_row<span class="op">$</span>Dataset,</span>
<span id="cb27-29"><a href="rq2.html#cb27-29"></a>              <span class="dt">DatasetType=</span>current_row<span class="op">$</span>DatasetType)</span>
<span id="cb27-30"><a href="rq2.html#cb27-30"></a>    </span>
<span id="cb27-31"><a href="rq2.html#cb27-31"></a>  }</span>
<span id="cb27-32"><a href="rq2.html#cb27-32"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="rq2.html#cb28-1"></a><span class="co">#now we loop each row of the rank wide dataset and create a new one</span></span>
<span id="cb28-2"><a href="rq2.html#cb28-2"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(d_acc_rank_<span class="dv">50</span>))</span>
<span id="cb28-3"><a href="rq2.html#cb28-3"></a>{</span>
<span id="cb28-4"><a href="rq2.html#cb28-4"></a>  current_row &lt;-<span class="st"> </span>d_acc_rank_<span class="dv">50</span>[i,]</span>
<span id="cb28-5"><a href="rq2.html#cb28-5"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(comb)){</span>
<span id="cb28-6"><a href="rq2.html#cb28-6"></a>    comb_row &lt;-<span class="st"> </span>comb[j,]</span>
<span id="cb28-7"><a href="rq2.html#cb28-7"></a>    </span>
<span id="cb28-8"><a href="rq2.html#cb28-8"></a>    model0_name &lt;-<span class="st"> </span>models[comb_row[<span class="dv">1</span>]]</span>
<span id="cb28-9"><a href="rq2.html#cb28-9"></a>    model0 &lt;-<span class="st"> </span>comb_row[<span class="dv">1</span>]</span>
<span id="cb28-10"><a href="rq2.html#cb28-10"></a>    model0_rank &lt;-<span class="st"> </span>current_row[[<span class="dv">1</span>,model0_name]]</span>
<span id="cb28-11"><a href="rq2.html#cb28-11"></a>    </span>
<span id="cb28-12"><a href="rq2.html#cb28-12"></a>    model1_name &lt;-<span class="st"> </span>models[comb_row[<span class="dv">2</span>]]</span>
<span id="cb28-13"><a href="rq2.html#cb28-13"></a>    model1 &lt;-<span class="st"> </span>comb_row[<span class="dv">2</span>]</span>
<span id="cb28-14"><a href="rq2.html#cb28-14"></a>    model1_rank &lt;-<span class="st"> </span>current_row[[<span class="dv">1</span>,model1_name]]</span>
<span id="cb28-15"><a href="rq2.html#cb28-15"></a>    </span>
<span id="cb28-16"><a href="rq2.html#cb28-16"></a>    diff_rank &lt;-<span class="st"> </span>model1_rank <span class="op">-</span><span class="st"> </span>model0_rank</span>
<span id="cb28-17"><a href="rq2.html#cb28-17"></a>    <span class="co">#SInce higher accuracy is better if model 1 rank- model 0 rank is positive than model1 wins and y=1 else y=0</span></span>
<span id="cb28-18"><a href="rq2.html#cb28-18"></a>    y &lt;-<span class="st"> </span><span class="kw">ifelse</span>(diff_rank<span class="op">&gt;</span><span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>) </span>
<span id="cb28-19"><a href="rq2.html#cb28-19"></a>    </span>
<span id="cb28-20"><a href="rq2.html#cb28-20"></a>    </span>
<span id="cb28-21"><a href="rq2.html#cb28-21"></a>    d_acc_bt_<span class="dv">50</span> &lt;-d_acc_bt_<span class="dv">50</span> <span class="op">%&gt;%</span><span class="st">  </span></span>
<span id="cb28-22"><a href="rq2.html#cb28-22"></a><span class="st">      </span><span class="kw">add_row</span>(<span class="dt">model0_name=</span>model0_name,</span>
<span id="cb28-23"><a href="rq2.html#cb28-23"></a>              <span class="dt">model0=</span>model0,</span>
<span id="cb28-24"><a href="rq2.html#cb28-24"></a>              <span class="dt">model1_name=</span>model1_name,</span>
<span id="cb28-25"><a href="rq2.html#cb28-25"></a>              <span class="dt">model1=</span>model1,</span>
<span id="cb28-26"><a href="rq2.html#cb28-26"></a>              <span class="dt">y=</span>y,</span>
<span id="cb28-27"><a href="rq2.html#cb28-27"></a>              <span class="dt">iterations=</span>current_row<span class="op">$</span>iterations,</span>
<span id="cb28-28"><a href="rq2.html#cb28-28"></a>              <span class="dt">Dataset=</span>current_row<span class="op">$</span>Dataset,</span>
<span id="cb28-29"><a href="rq2.html#cb28-29"></a>              <span class="dt">DatasetType=</span>current_row<span class="op">$</span>DatasetType)</span>
<span id="cb28-30"><a href="rq2.html#cb28-30"></a>    </span>
<span id="cb28-31"><a href="rq2.html#cb28-31"></a>  }</span>
<span id="cb28-32"><a href="rq2.html#cb28-32"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="rq2.html#cb29-1"></a>m10_data &lt;-<span class="st"> </span><span class="kw">list</span>(</span>
<span id="cb29-2"><a href="rq2.html#cb29-2"></a>  <span class="dt">N_total=</span><span class="kw">nrow</span>(d_acc_bt_<span class="dv">10</span>),</span>
<span id="cb29-3"><a href="rq2.html#cb29-3"></a>  <span class="dt">y =</span> <span class="kw">as.integer</span>(d_acc_bt_<span class="dv">10</span><span class="op">$</span>y),</span>
<span id="cb29-4"><a href="rq2.html#cb29-4"></a>  <span class="dt">N_models =</span> <span class="kw">as.integer</span>(n_models),</span>
<span id="cb29-5"><a href="rq2.html#cb29-5"></a>  <span class="dt">model0=</span><span class="kw">as.integer</span>(d_acc_bt_<span class="dv">10</span><span class="op">$</span>model0),</span>
<span id="cb29-6"><a href="rq2.html#cb29-6"></a>  <span class="dt">model1=</span><span class="kw">as.integer</span>(d_acc_bt_<span class="dv">10</span><span class="op">$</span>model1)</span>
<span id="cb29-7"><a href="rq2.html#cb29-7"></a>  )</span></code></pre></div>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="rq2.html#cb30-1"></a>m50_data &lt;-<span class="st"> </span><span class="kw">list</span>(</span>
<span id="cb30-2"><a href="rq2.html#cb30-2"></a>  <span class="dt">N_total=</span><span class="kw">nrow</span>(d_acc_bt_<span class="dv">50</span>),</span>
<span id="cb30-3"><a href="rq2.html#cb30-3"></a>  <span class="dt">y =</span> <span class="kw">as.integer</span>(d_acc_bt_<span class="dv">50</span><span class="op">$</span>y),</span>
<span id="cb30-4"><a href="rq2.html#cb30-4"></a>  <span class="dt">N_models =</span> <span class="kw">as.integer</span>(n_models),</span>
<span id="cb30-5"><a href="rq2.html#cb30-5"></a>  <span class="dt">model0=</span><span class="kw">as.integer</span>(d_acc_bt_<span class="dv">50</span><span class="op">$</span>model0),</span>
<span id="cb30-6"><a href="rq2.html#cb30-6"></a>  <span class="dt">model1=</span><span class="kw">as.integer</span>(d_acc_bt_<span class="dv">50</span><span class="op">$</span>model1)</span>
<span id="cb30-7"><a href="rq2.html#cb30-7"></a>  )</span></code></pre></div>
<p>we use the same model but with different data</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="rq2.html#cb31-1"></a>m10_fit &lt;-<span class="st"> </span><span class="kw">stan</span>(<span class="dt">file =</span> <span class="st">&#39;./models/rankingmodel.stan&#39;</span>,</span>
<span id="cb31-2"><a href="rq2.html#cb31-2"></a>                     <span class="dt">data=</span>m10_data,</span>
<span id="cb31-3"><a href="rq2.html#cb31-3"></a>                     <span class="dt">chains =</span> <span class="dv">4</span>,</span>
<span id="cb31-4"><a href="rq2.html#cb31-4"></a>                     <span class="dt">warmup =</span> <span class="dv">200</span>,</span>
<span id="cb31-5"><a href="rq2.html#cb31-5"></a>                     <span class="dt">iter =</span> <span class="dv">2000</span>)</span>
<span id="cb31-6"><a href="rq2.html#cb31-6"></a><span class="kw">saveRDS</span>(m10_fit, <span class="dt">file =</span> <span class="st">&quot;./data/m10_fit.RDS&quot;</span>)</span>
<span id="cb31-7"><a href="rq2.html#cb31-7"></a></span>
<span id="cb31-8"><a href="rq2.html#cb31-8"></a>m50_fit &lt;-<span class="st"> </span><span class="kw">stan</span>(<span class="dt">file =</span> <span class="st">&#39;./models/rankingmodel.stan&#39;</span>,</span>
<span id="cb31-9"><a href="rq2.html#cb31-9"></a>                     <span class="dt">data=</span>m50_data,</span>
<span id="cb31-10"><a href="rq2.html#cb31-10"></a>                     <span class="dt">chains =</span> <span class="dv">4</span>,</span>
<span id="cb31-11"><a href="rq2.html#cb31-11"></a>                     <span class="dt">warmup =</span> <span class="dv">200</span>,</span>
<span id="cb31-12"><a href="rq2.html#cb31-12"></a>                     <span class="dt">iter =</span> <span class="dv">2000</span>)</span>
<span id="cb31-13"><a href="rq2.html#cb31-13"></a><span class="kw">saveRDS</span>(m50_fit, <span class="dt">file =</span> <span class="st">&quot;./data/m50_fit.RDS&quot;</span>)</span></code></pre></div>
</div>
<div id="results-for-10" class="section level2">
<h2><span class="header-section-number">2.3</span> Results for 10%</h2>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="rq2.html#cb32-1"></a>m10_fit &lt;-<span class="kw">readRDS</span>(<span class="st">&quot;./data/m10_fit.RDS&quot;</span>)</span>
<span id="cb32-2"><a href="rq2.html#cb32-2"></a>a_model &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;a_model[1]&quot;</span>,</span>
<span id="cb32-3"><a href="rq2.html#cb32-3"></a>           <span class="st">&quot;a_model[2]&quot;</span>,</span>
<span id="cb32-4"><a href="rq2.html#cb32-4"></a>           <span class="st">&quot;a_model[3]&quot;</span>,</span>
<span id="cb32-5"><a href="rq2.html#cb32-5"></a>           <span class="st">&quot;a_model[4]&quot;</span>,</span>
<span id="cb32-6"><a href="rq2.html#cb32-6"></a>           <span class="st">&quot;a_model[5]&quot;</span>,</span>
<span id="cb32-7"><a href="rq2.html#cb32-7"></a>           <span class="st">&quot;a_model[6]&quot;</span>,</span>
<span id="cb32-8"><a href="rq2.html#cb32-8"></a>           <span class="st">&quot;a_model[7]&quot;</span>)</span>
<span id="cb32-9"><a href="rq2.html#cb32-9"></a>rstan<span class="op">::</span><span class="kw">traceplot</span>(m10_fit, <span class="dt">pars=</span>a_model)</span></code></pre></div>
<p><img src="automatic-labelling_files/figure-html/unnamed-chunk-27-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="rq2.html#cb33-1"></a>hpdi &lt;-<span class="st"> </span><span class="kw">get_HPDI_from_stanfit</span>(m10_fit)</span>
<span id="cb33-2"><a href="rq2.html#cb33-2"></a></span>
<span id="cb33-3"><a href="rq2.html#cb33-3"></a>hpdi_algorithm &lt;-<span class="st"> </span>hpdi <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb33-4"><a href="rq2.html#cb33-4"></a><span class="st">      </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(Parameter, <span class="st">&quot;a_model</span><span class="ch">\\</span><span class="st">[&quot;</span>)) <span class="op">%&gt;%</span></span>
<span id="cb33-5"><a href="rq2.html#cb33-5"></a><span class="st">      </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">Parameter=</span>models) </span>
<span id="cb33-6"><a href="rq2.html#cb33-6"></a></span>
<span id="cb33-7"><a href="rq2.html#cb33-7"></a>p&lt;-<span class="kw">ggplot</span>(<span class="dt">data=</span>hpdi_algorithm, <span class="kw">aes</span>(<span class="dt">x=</span>Parameter))<span class="op">+</span></span>
<span id="cb33-8"><a href="rq2.html#cb33-8"></a><span class="st">  </span><span class="kw">geom_pointrange</span>(<span class="kw">aes</span>(</span>
<span id="cb33-9"><a href="rq2.html#cb33-9"></a>    <span class="dt">ymin=</span>HPDI.lower, </span>
<span id="cb33-10"><a href="rq2.html#cb33-10"></a>    <span class="dt">ymax=</span>HPDI.higher, </span>
<span id="cb33-11"><a href="rq2.html#cb33-11"></a>    <span class="dt">y=</span>Mean))<span class="op">+</span></span>
<span id="cb33-12"><a href="rq2.html#cb33-12"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y=</span><span class="st">&quot;Estimate&quot;</span>, <span class="dt">x=</span><span class="st">&quot;Model&quot;</span>, <span class="dt">title =</span> <span class="st">&quot;HPDI of the strength of the model with 10% of available labels&quot;</span>)<span class="op">+</span></span>
<span id="cb33-13"><a href="rq2.html#cb33-13"></a><span class="st">  </span><span class="kw">coord_flip</span>()</span>
<span id="cb33-14"><a href="rq2.html#cb33-14"></a>p</span></code></pre></div>
<p><img src="automatic-labelling_files/figure-html/unnamed-chunk-28-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="rq2.html#cb34-1"></a><span class="kw">save_fig</span>(p,<span class="st">&#39;strength-10.pdf&#39;</span>)</span></code></pre></div>
<p>Here we are extracting all samples and ranking them to have a distribution of the ranks</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="rq2.html#cb35-1"></a>posterior &lt;-<span class="st"> </span>rstan<span class="op">::</span><span class="kw">extract</span>(m10_fit)</span>
<span id="cb35-2"><a href="rq2.html#cb35-2"></a>a_model &lt;-<span class="st"> </span><span class="kw">as_tibble</span>(posterior<span class="op">$</span>a_model)</span>
<span id="cb35-3"><a href="rq2.html#cb35-3"></a><span class="kw">colnames</span>(a_model) &lt;-<span class="st"> </span>models</span>
<span id="cb35-4"><a href="rq2.html#cb35-4"></a><span class="co">#sampling from the posterior</span></span>
<span id="cb35-5"><a href="rq2.html#cb35-5"></a>s &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw">sample_n</span>(a_model, <span class="dt">size =</span> <span class="dv">1000</span>, <span class="dt">replace=</span>T)</span>
<span id="cb35-6"><a href="rq2.html#cb35-6"></a>s &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(s, <span class="dt">rown =</span> <span class="kw">row_number</span>())</span>
<span id="cb35-7"><a href="rq2.html#cb35-7"></a>wide_s &lt;-<span class="st"> </span>tidyr<span class="op">::</span><span class="kw">pivot_longer</span>(s, <span class="dt">cols=</span><span class="kw">all_of</span>(models), <span class="dt">names_to =</span> <span class="st">&quot;Models&quot;</span>, <span class="dt">values_to =</span> <span class="st">&quot;a_model&quot;</span>)</span>
<span id="cb35-8"><a href="rq2.html#cb35-8"></a></span>
<span id="cb35-9"><a href="rq2.html#cb35-9"></a>rank_df &lt;-<span class="st"> </span>wide_s <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb35-10"><a href="rq2.html#cb35-10"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(rown) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb35-11"><a href="rq2.html#cb35-11"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">Rank =</span> <span class="kw">rank</span>(<span class="op">-</span>a_model, <span class="dt">ties.method =</span> <span class="st">&#39;random&#39;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb35-12"><a href="rq2.html#cb35-12"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb35-13"><a href="rq2.html#cb35-13"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>a_model) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb35-14"><a href="rq2.html#cb35-14"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(Models) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb35-15"><a href="rq2.html#cb35-15"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">MedianRank =</span> <span class="kw">median</span>(Rank),</span>
<span id="cb35-16"><a href="rq2.html#cb35-16"></a>                   <span class="dt">VarianceRank =</span> <span class="kw">var</span>(Rank)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb35-17"><a href="rq2.html#cb35-17"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(MedianRank)</span></code></pre></div>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="rq2.html#cb36-1"></a>rank_df_table &lt;-<span class="st"> </span>rank_df</span>
<span id="cb36-2"><a href="rq2.html#cb36-2"></a><span class="kw">colnames</span>(rank_df_table) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Models&quot;</span>,<span class="st">&quot;Median Rank&quot;</span>, <span class="st">&quot;Variance of the Rank&quot;</span>)</span>
<span id="cb36-3"><a href="rq2.html#cb36-3"></a><span class="kw">kable</span>(rank_df_table, <span class="st">&quot;html&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb36-4"><a href="rq2.html#cb36-4"></a><span class="st">  </span><span class="kw">kable_styling</span>(<span class="dt">bootstrap_options =</span> <span class="kw">c</span>(<span class="st">&#39;striped&#39;</span>,<span class="st">&quot;hover&quot;</span>, <span class="st">&quot;condensed&quot;</span> ))</span></code></pre></div>
<table class="table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Models
</th>
<th style="text-align:right;">
Median Rank
</th>
<th style="text-align:right;">
Variance of the Rank
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
UncertaintySampling
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0513473
</td>
</tr>
<tr>
<td style="text-align:left;">
QBC
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.1571331
</td>
</tr>
<tr>
<td style="text-align:left;">
LabelSpreadingKNN
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0.3235546
</td>
</tr>
<tr>
<td style="text-align:left;">
RandomSampling
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0.2994905
</td>
</tr>
<tr>
<td style="text-align:left;">
LabelSpreadingRBF
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0.0000000
</td>
</tr>
<tr>
<td style="text-align:left;">
LabelPropagationRBF
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
0.0000000
</td>
</tr>
<tr>
<td style="text-align:left;">
LabelPropagationKNN
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
0.0000000
</td>
</tr>
</tbody>
</table>
<p>saving the table to latex</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="rq2.html#cb37-1"></a>rank_df_table <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb37-2"><a href="rq2.html#cb37-2"></a><span class="st">  </span><span class="kw">kable</span>(</span>
<span id="cb37-3"><a href="rq2.html#cb37-3"></a>      <span class="st">&quot;latex&quot;</span>, </span>
<span id="cb37-4"><a href="rq2.html#cb37-4"></a>      <span class="dt">table.envir =</span> <span class="st">&#39;table&#39;</span>,</span>
<span id="cb37-5"><a href="rq2.html#cb37-5"></a>      <span class="dt">caption=</span><span class="st">&#39;Ranking of the algorithms with 10% of available labels&#39;</span>, </span>
<span id="cb37-6"><a href="rq2.html#cb37-6"></a>      <span class="dt">booktabs=</span>T,</span>
<span id="cb37-7"><a href="rq2.html#cb37-7"></a>      <span class="dt">label=</span><span class="st">&#39;ranking10&#39;</span>,</span>
<span id="cb37-8"><a href="rq2.html#cb37-8"></a>      <span class="dt">format.args =</span> <span class="kw">list</span>(<span class="dt">scientific =</span> <span class="ot">FALSE</span>), </span>
<span id="cb37-9"><a href="rq2.html#cb37-9"></a>      <span class="dt">digits =</span> <span class="dv">3</span>,</span>
<span id="cb37-10"><a href="rq2.html#cb37-10"></a>      <span class="dt">linesep =</span> <span class="st">&quot;&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb37-11"><a href="rq2.html#cb37-11"></a><span class="st">  </span><span class="kw">kable_styling</span>(<span class="dt">latex_options =</span> <span class="kw">c</span>(<span class="st">&quot;hold_position&quot;</span>),</span>
<span id="cb37-12"><a href="rq2.html#cb37-12"></a>                <span class="dt">full_width =</span> F) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb37-13"><a href="rq2.html#cb37-13"></a><span class="st">  </span>readr<span class="op">::</span><span class="kw">write_lines</span>(<span class="st">&#39;./paper/ranking10.tex&#39;</span>)</span></code></pre></div>
</div>
<div id="results-for-50" class="section level2">
<h2><span class="header-section-number">2.4</span> Results for 50%</h2>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="rq2.html#cb38-1"></a>m50_fit &lt;-<span class="kw">readRDS</span>(<span class="st">&quot;./data/m50_fit.RDS&quot;</span>)</span>
<span id="cb38-2"><a href="rq2.html#cb38-2"></a>a_model &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;a_model[1]&quot;</span>,</span>
<span id="cb38-3"><a href="rq2.html#cb38-3"></a>           <span class="st">&quot;a_model[2]&quot;</span>,</span>
<span id="cb38-4"><a href="rq2.html#cb38-4"></a>           <span class="st">&quot;a_model[3]&quot;</span>,</span>
<span id="cb38-5"><a href="rq2.html#cb38-5"></a>           <span class="st">&quot;a_model[4]&quot;</span>,</span>
<span id="cb38-6"><a href="rq2.html#cb38-6"></a>           <span class="st">&quot;a_model[5]&quot;</span>,</span>
<span id="cb38-7"><a href="rq2.html#cb38-7"></a>           <span class="st">&quot;a_model[6]&quot;</span>,</span>
<span id="cb38-8"><a href="rq2.html#cb38-8"></a>           <span class="st">&quot;a_model[7]&quot;</span>)</span>
<span id="cb38-9"><a href="rq2.html#cb38-9"></a>rstan<span class="op">::</span><span class="kw">traceplot</span>(m50_fit, <span class="dt">pars=</span>a_model)</span></code></pre></div>
<p><img src="automatic-labelling_files/figure-html/unnamed-chunk-32-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="rq2.html#cb39-1"></a>hpdi &lt;-<span class="st"> </span><span class="kw">get_HPDI_from_stanfit</span>(m50_fit)</span>
<span id="cb39-2"><a href="rq2.html#cb39-2"></a></span>
<span id="cb39-3"><a href="rq2.html#cb39-3"></a>hpdi_algorithm &lt;-<span class="st"> </span>hpdi <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb39-4"><a href="rq2.html#cb39-4"></a><span class="st">      </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="kw">str_detect</span>(Parameter, <span class="st">&quot;a_model</span><span class="ch">\\</span><span class="st">[&quot;</span>)) <span class="op">%&gt;%</span></span>
<span id="cb39-5"><a href="rq2.html#cb39-5"></a><span class="st">      </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">Parameter=</span>models) </span>
<span id="cb39-6"><a href="rq2.html#cb39-6"></a></span>
<span id="cb39-7"><a href="rq2.html#cb39-7"></a>p&lt;-<span class="kw">ggplot</span>(<span class="dt">data=</span>hpdi_algorithm, <span class="kw">aes</span>(<span class="dt">x=</span>Parameter))<span class="op">+</span></span>
<span id="cb39-8"><a href="rq2.html#cb39-8"></a><span class="st">  </span><span class="kw">geom_pointrange</span>(<span class="kw">aes</span>(</span>
<span id="cb39-9"><a href="rq2.html#cb39-9"></a>    <span class="dt">ymin=</span>HPDI.lower, </span>
<span id="cb39-10"><a href="rq2.html#cb39-10"></a>    <span class="dt">ymax=</span>HPDI.higher, </span>
<span id="cb39-11"><a href="rq2.html#cb39-11"></a>    <span class="dt">y=</span>Mean))<span class="op">+</span></span>
<span id="cb39-12"><a href="rq2.html#cb39-12"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y=</span><span class="st">&quot;Estimate&quot;</span>, <span class="dt">x=</span><span class="st">&quot;Model&quot;</span>, <span class="dt">title =</span> <span class="st">&quot;HPDI of the strength of the model with 50% of available labels&quot;</span>)<span class="op">+</span></span>
<span id="cb39-13"><a href="rq2.html#cb39-13"></a><span class="st">  </span><span class="kw">coord_flip</span>()</span>
<span id="cb39-14"><a href="rq2.html#cb39-14"></a>p</span></code></pre></div>
<p><img src="automatic-labelling_files/figure-html/unnamed-chunk-33-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="rq2.html#cb40-1"></a><span class="kw">save_fig</span>(p,<span class="st">&#39;strength-50.pdf&#39;</span>)</span></code></pre></div>
<p>Here we are extracting all samples and ranking them to have a distribution of the ranks</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="rq2.html#cb41-1"></a>posterior &lt;-<span class="st"> </span>rstan<span class="op">::</span><span class="kw">extract</span>(m50_fit)</span>
<span id="cb41-2"><a href="rq2.html#cb41-2"></a>a_model &lt;-<span class="st"> </span><span class="kw">as_tibble</span>(posterior<span class="op">$</span>a_model)</span>
<span id="cb41-3"><a href="rq2.html#cb41-3"></a><span class="kw">colnames</span>(a_model) &lt;-<span class="st"> </span>models</span>
<span id="cb41-4"><a href="rq2.html#cb41-4"></a><span class="co">#sampling from the posterior</span></span>
<span id="cb41-5"><a href="rq2.html#cb41-5"></a>s &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw">sample_n</span>(a_model, <span class="dt">size =</span> <span class="dv">1000</span>, <span class="dt">replace=</span>T)</span>
<span id="cb41-6"><a href="rq2.html#cb41-6"></a>s &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(s, <span class="dt">rown =</span> <span class="kw">row_number</span>())</span>
<span id="cb41-7"><a href="rq2.html#cb41-7"></a>wide_s &lt;-<span class="st"> </span>tidyr<span class="op">::</span><span class="kw">pivot_longer</span>(s, <span class="dt">cols=</span><span class="kw">all_of</span>(models), <span class="dt">names_to =</span> <span class="st">&quot;Models&quot;</span>, <span class="dt">values_to =</span> <span class="st">&quot;a_model&quot;</span>)</span>
<span id="cb41-8"><a href="rq2.html#cb41-8"></a></span>
<span id="cb41-9"><a href="rq2.html#cb41-9"></a>rank_df &lt;-<span class="st"> </span>wide_s <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb41-10"><a href="rq2.html#cb41-10"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(rown) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb41-11"><a href="rq2.html#cb41-11"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">Rank =</span> <span class="kw">rank</span>(<span class="op">-</span>a_model, <span class="dt">ties.method =</span> <span class="st">&#39;random&#39;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb41-12"><a href="rq2.html#cb41-12"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb41-13"><a href="rq2.html#cb41-13"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>a_model) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb41-14"><a href="rq2.html#cb41-14"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">group_by</span>(Models) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb41-15"><a href="rq2.html#cb41-15"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">MedianRank =</span> <span class="kw">median</span>(Rank),</span>
<span id="cb41-16"><a href="rq2.html#cb41-16"></a>                   <span class="dt">VarianceRank =</span> <span class="kw">var</span>(Rank)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb41-17"><a href="rq2.html#cb41-17"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(MedianRank)</span></code></pre></div>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="rq2.html#cb42-1"></a>rank_df_table &lt;-<span class="st"> </span>rank_df</span>
<span id="cb42-2"><a href="rq2.html#cb42-2"></a><span class="kw">colnames</span>(rank_df_table) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Models&quot;</span>,<span class="st">&quot;Median Rank&quot;</span>, <span class="st">&quot;Variance of the Rank&quot;</span>)</span>
<span id="cb42-3"><a href="rq2.html#cb42-3"></a><span class="kw">kable</span>(rank_df_table, <span class="st">&quot;html&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb42-4"><a href="rq2.html#cb42-4"></a><span class="st">  </span><span class="kw">kable_styling</span>(<span class="dt">bootstrap_options =</span> <span class="kw">c</span>(<span class="st">&#39;striped&#39;</span>,<span class="st">&quot;hover&quot;</span>, <span class="st">&quot;condensed&quot;</span> ))</span></code></pre></div>
<table class="table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Models
</th>
<th style="text-align:right;">
Median Rank
</th>
<th style="text-align:right;">
Variance of the Rank
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
LabelSpreadingKNN
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0.0039880
</td>
</tr>
<tr>
<td style="text-align:left;">
UncertaintySampling
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0.3531972
</td>
</tr>
<tr>
<td style="text-align:left;">
QBC
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0.3588028
</td>
</tr>
<tr>
<td style="text-align:left;">
RandomSampling
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0.1614725
</td>
</tr>
<tr>
<td style="text-align:left;">
LabelSpreadingRBF
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
0.0029940
</td>
</tr>
<tr>
<td style="text-align:left;">
LabelPropagationKNN
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
0.2343584
</td>
</tr>
<tr>
<td style="text-align:left;">
LabelPropagationRBF
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
0.2343584
</td>
</tr>
</tbody>
</table>
<p>saving the table to latex</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="rq2.html#cb43-1"></a>rank_df_table <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb43-2"><a href="rq2.html#cb43-2"></a><span class="st">  </span><span class="kw">kable</span>(</span>
<span id="cb43-3"><a href="rq2.html#cb43-3"></a>      <span class="st">&quot;latex&quot;</span>, </span>
<span id="cb43-4"><a href="rq2.html#cb43-4"></a>      <span class="dt">table.envir =</span> <span class="st">&#39;table&#39;</span>,</span>
<span id="cb43-5"><a href="rq2.html#cb43-5"></a>      <span class="dt">caption=</span><span class="st">&#39;Ranking of the algorithms with 50% of available labels&#39;</span>, </span>
<span id="cb43-6"><a href="rq2.html#cb43-6"></a>      <span class="dt">booktabs=</span>T,</span>
<span id="cb43-7"><a href="rq2.html#cb43-7"></a>      <span class="dt">label=</span><span class="st">&#39;ranking10&#39;</span>,</span>
<span id="cb43-8"><a href="rq2.html#cb43-8"></a>      <span class="dt">format.args =</span> <span class="kw">list</span>(<span class="dt">scientific =</span> <span class="ot">FALSE</span>), </span>
<span id="cb43-9"><a href="rq2.html#cb43-9"></a>      <span class="dt">digits =</span> <span class="dv">3</span>,</span>
<span id="cb43-10"><a href="rq2.html#cb43-10"></a>      <span class="dt">linesep =</span> <span class="st">&quot;&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb43-11"><a href="rq2.html#cb43-11"></a><span class="st">  </span><span class="kw">kable_styling</span>(<span class="dt">latex_options =</span> <span class="kw">c</span>(<span class="st">&quot;hold_position&quot;</span>),</span>
<span id="cb43-12"><a href="rq2.html#cb43-12"></a>                <span class="dt">full_width =</span> F) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb43-13"><a href="rq2.html#cb43-13"></a><span class="st">  </span>readr<span class="op">::</span><span class="kw">write_lines</span>(<span class="st">&#39;./paper/ranking50.tex&#39;</span>)</span></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="rq1.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
